(()=>{var o={n:a=>{var r=a&&a.__esModule?()=>a.default:()=>a;return o.d(r,{a:r}),r},d:(a,r)=>{for(var i in r)o.o(r,i)&&!o.o(a,i)&&Object.defineProperty(a,i,{enumerable:!0,get:r[i]})},o:(o,a)=>Object.prototype.hasOwnProperty.call(o,a)};(()=>{"use strict";const a=flarum.core.compat["common/models/Discussion"];var r=o.n(a);const i=flarum.core.compat["common/Model"];var n=o.n(i);function e(){return e=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var i in r)({}).hasOwnProperty.call(r,i)&&(o[i]=r[i])}return o},e.apply(null,arguments)}const l=flarum.core.compat["common/extend"],t=flarum.core.compat["forum/components/DiscussionListItem"];var s=o.n(t);const c=flarum.core.compat["utils/string"],u=flarum.core.compat["common/helpers/textContrastClass"];var d=o.n(u);const g=flarum.core.compat["common/utils/classList"];var C=o.n(g);const y=flarum.core.compat["common/components/Link"];var p=o.n(y);const B=flarum.core.compat["common/helpers/highlight"];var k=o.n(B);const h=flarum.core.compat["common/helpers/listItems"];var f=o.n(h);function T(o,a){var r="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(r)return(r=r.call(o)).next.bind(r);if(Array.isArray(o)||(r=function(o,a){if(o){if("string"==typeof o)return F(o,a);var r={}.toString.call(o).slice(8,-1);return"Object"===r&&o.constructor&&(r=o.constructor.name),"Map"===r||"Set"===r?Array.from(o):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(o,a):void 0}}(o))||a&&o&&"number"==typeof o.length){r&&(o=r);var i=0;return function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(o,a){(null==a||a>o.length)&&(a=o.length);for(var r=0,i=Array(a);r<a;r++)i[r]=o[r];return i}app.initializers.add("yippy-tag-with-themes",(function(){r().prototype.isTagWithThemesEnabled=n().attribute("isTagWithThemesEnabled"),function(){var o,a,r,i,n,t={Automatic:null,White:"text-contrast--light",WhiteWithBorder:"outlinetextblackborder",Black:"text-contrast--dark",BlackWithBorder:"outlinetextwhiteborder"},u={StickyNote:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},Basic:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},Flat:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorder:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorderTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorderTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorderBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1}};function g(e,l){o=a=r=i=null,n={tag:"span",attrs:{class:"DiscussionListItem--secondary",style:{}},children:[]},o=l.forum.attribute("yippy-tag-with-themes.designDefault");var s=l.forum.attribute("yippy-tag-with-themes.designByTags"),c=null;if(e&&e.length>0)for(var g,y=T(e);!(g=y()).done;){var p=g.value;p.data.attributes.isChild?i=p:null==p.data.attributes.position||(r=p)}if(r)for(var B,k=T(s);!(B=k()).done;){var h=B.value;if(h.isEnabled&&h.tags.includes(r.id())){o=h.themeName,c={primaryBackgroundColor:h.primaryBackgroundColor,primaryFontClass:t[h.primaryFontClass],childBackgroundColor:h.childBackgroundColor,childFontClass:t[h.childFontClass],outlineBackgroundColor:h.outlineBackgroundColor,unreadColor:h.unreadColor,secondaryFontClass:t[h.secondaryFontClass],opacityBackground:h.opacityBackground,opacityFooter:h.opacityFooter,opacityOutline:h.opacityOutline};break}}if(o&&"None"!=o&&(a=u[o],c&&(a=Object.assign({},a,c)),e&&e.length>0))for(var f,F=T(e);!(f=F()).done;){var b=f.value;null==b.data.attributes.position&&n.children.push(m("span",{class:"TagLabel",style:"--tag-bg:"+b.color()},m("span",{class:C()("TagLabel-text",a.secondaryFontClass?a.secondaryFontClass:d()(b.color()))},m("i",{class:"TagLabel-icon "+b.data.attributes.icon}),m("span",{class:"TagLabel-name"},b.data.attributes.name))))}}function y(o,a){var r=parseInt(o.slice(1,3),16),i=parseInt(o.slice(3,5),16),n=parseInt(o.slice(5,7),16);return a?"rgba("+r+", "+i+", "+n+", "+a+")":"rgb("+r+", "+i+", "+n+")"}(0,l.extend)(s().prototype,"view",(function(l){var t=this.attrs.discussion;if(a){var s=l.children.find((function(o){return o&&"div"===o.tag&&o.attrs&&o.attrs.className.includes("DiscussionListItem-content")}));s.children[0]=m("div",{className:"DiscussionListItem-author-container"},[s.children[0],s.children[1]]),delete s.children[1],s.children[3]=m("div",{className:"DiscussionListItem-stats"},s.children[3]);var c=a.opacityFooter;if(r){null==i&&(i=r);var u=a.isPrimaryTagBackgroundColorRequired?r.color():a.primaryBackgroundColor,g=y(u,c);if(a.isPrimaryTagAnButton){var p="DiscussionListItem-footer";switch(o){case"StickyNoteTab":case"StickyNoteOutlineTab":case"BasicTab":case"BasicOutlineTab":case"FlatTab":case"FlatBorderTab":p="DiscussionListItem--tabfooter"}s.children.push(m("span",{class:p},m("span",{class:"PrimaryTagLabel",style:"background:"+g},m("span",{class:C()("PrimaryTagLabel-text",a.primaryFontClass?a.primaryFontClass:d()(u))},m("i",{class:"PrimaryTagLabel-icon "+r.data.attributes.icon+" fa-1x"}),m("span",{class:"PrimaryTagLabel-name"},r.data.attributes.name))),n))}else s.children.push(m("span",{class:C()("DiscussionListItem-footer",a.primaryFontClass?a.primaryFontClass:d()(u)),style:"background:"+g},m("span",{class:"DiscussionListItem--primary"},m("i",{"aria-hidden":"true",class:"TagLabel-icon "+r.data.attributes.icon+" fa-1x"}),r.data.attributes.name),n))}var B=a.outlineBackgroundColor,k=a.opacityOutline;switch(i&&(B=i.color()),B=y(B,k),o){case"StickyNoteTab":case"BasicTab":i&&s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -15px -15px 0px 0px "+B}));break;case"StickyNoteOutline":case"StickyNoteOutlineTag":case"StickyNoteOutlineBanner":case"BasicOutline":case"BasicOutlineTag":case"BasicOutlineBanner":s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+B+"; height: 100%; bottom: 0;"}));break;case"FlatBorder":case"FlatBorderTag":case"FlatBorderBanner":s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+B+"; height: 100%; bottom: 0;"}));break;case"StickyNoteOutlineTab":case"BasicOutlineTab":i?s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+B+";height: calc(100% - 18px); bottom: 18px;"})):s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+B+"; height: 100%; bottom: 0;"}));break;case"FlatBorderTab":i?s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+B+";height: calc(100% - 18px); bottom: 22px;"})):s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+B+"; height: 100%; bottom: 0;"}))}var h=a.unreadCSS,f=a.opacityBackground;l.attrs.style=e(i?{background:a.isChildTagBackgroundColorRequired?y(i.color(),f):y(a.childBackgroundColor,f)}:{background:y(a.childBackgroundColor,f)},l.attrs.style||{}),t.isUnread()&&s.children.push(m("span",{class:"DiscussionListItem--unreadoutline"+h,style:"background:"+a.unreadColor+"; color:"+a.unreadColor})),"folded"==h&&(i?(l.attrs.style=e({background:a.isChildTagBackgroundColorRequired?i.color():a.childBackgroundColor},l.attrs.style||{}),s.children.push(m("span",{class:"DiscussionListItem--read"+h,style:"border-color:"+(a.isOutlineTagBackgroundColorRequired?i.color():a.outlineBackgroundColor)}))):s.children.push(m("span",{class:"DiscussionListItem--read"+h,style:"border-color:"+a.outlineBackgroundColor}))),l.attrs.className+=" TagWithThemes "+o}})),(0,l.override)(s().prototype,"mainView",(function(){var o=this.attrs.discussion,n=this.getJumpTo();if(o.isTagWithThemesEnabled()&&(g(o.tags(),app),a)){var e=d()(a.childBackgroundColor);return a.isChildTagBackgroundColorRequired&&(i?e=a.childFontClass?a.childFontClass:d()(i.color()):r&&(e=a.childFontClass?a.childFontClass:d()(r.color()))),m(p(),{href:app.route.discussion(o,n),className:"DiscussionListItem-main"},m("h2",{className:C()("DiscussionListItem-title-edit",e)},k()(o.title(),this.highlightRegExp)),m("ul",{className:C()("DiscussionListItem-info-edit",e)},f()(this.infoItems().toArray())))}return m(p(),{href:app.route.discussion(o,n),className:"DiscussionListItem-main"},m("h2",{className:"DiscussionListItem-title"},k()(o.title(),this.highlightRegExp)),m("ul",{className:"DiscussionListItem-info"},f()(this.infoItems().toArray())))})),(0,l.extend)(s().prototype,"infoItems",(function(o){var r=this.attrs.discussion;if(r.isTagWithThemesEnabled()&&!a&&g(r.tags(),app),a){var i=null;if(r.tags()&&r.tags().length>1)for(var n,e=T(r.tags());!(n=e()).done;){var l=n.value;if(l.data.attributes.isChild){i=l;break}}if(!o.has("excerpt")){var t=r.firstPost();if(t){var s=(0,c.truncate)(t.contentPlain(),175);o.add("excerpt",m("div",null,s),-100)}}o.has("tags")&&o.remove("tags"),i?o.add("tag",m("span",{class:"TagLabel-inner"},m("center",null,m("i",{"aria-hidden":"true",class:"TagLabel-icon "+i.data.attributes.icon+" fa-1x"}),i.data.attributes.name)),-100):o.add("tag",m("span",{class:"TagLabel-inner"}),-100)}}))}()}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map