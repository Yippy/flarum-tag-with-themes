(()=>{var r={n:o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return r.d(a,{a}),a},d:(o,a)=>{for(var e in a)r.o(a,e)&&!r.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:a[e]})},o:(r,o)=>Object.prototype.hasOwnProperty.call(r,o)};(()=>{"use strict";const o=flarum.reg.get("core","common/models/Discussion");var a=r.n(o);const e=flarum.reg.get("core","common/Model");var n=r.n(e);function l(r){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},l(r)}function i(r,o,a){return(o=function(r){var o=function(r){if("object"!=l(r)||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var a=o.call(r,"string");if("object"!=l(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(r);return"symbol"==l(o)?o:o+""}(o))in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,r}const s=flarum.reg.get("core","common/extend"),t=flarum.reg.get("core","forum/components/DiscussionListItem");var u=r.n(t);const c=flarum.reg.get("core","common/utils/string"),d=flarum.reg.get("core","common/helpers/textContrastClass");var g=r.n(d);const C=flarum.reg.get("core","common/utils/classList");var B=r.n(C);const y=flarum.reg.get("core","common/components/Link");var h=r.n(y);const k=flarum.reg.get("core","common/helpers/highlight");var p=r.n(k);const f=flarum.reg.get("core","common/helpers/listItems");var T=r.n(f);function b(r,o){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);o&&(e=e.filter((function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable}))),a.push.apply(a,e)}return a}function F(r){for(var o=1;o<arguments.length;o++){var a=null!=arguments[o]?arguments[o]:{};o%2?b(Object(a),!0).forEach((function(o){i(r,o,a[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(a,o))}))}return r}app.initializers.add("yippy-tag-with-themes",(()=>{a().prototype.isTagWithThemesEnabled=n().attribute("isTagWithThemesEnabled"),function(){const r={Automatic:null,White:"text-contrast--light",WhiteWithBorder:"outlinetextblackborder",Black:"text-contrast--dark",BlackWithBorder:"outlinetextwhiteborder"},o={StickyNote:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},Basic:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},Flat:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorder:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorderTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorderTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorderBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null}};let a,e,n,l,i;function t(s,t){a=e=n=l=null,i={tag:"span",attrs:{class:"DiscussionListItem--secondary",style:{}},children:[]},a=t.forum.attribute("yippy-tag-with-themes.designDefault");const u=t.forum.attribute("yippy-tag-with-themes.designByTags");let c=null;if(s&&s.length>0)for(const r of s)r.data.attributes.isChild?l=r:null==r.data.attributes.position||(n=r);if(n)for(const o of u)if(o.isEnabled&&o.tags.includes(n.id())){a=o.themeName,c={primaryBackgroundColor:o.primaryBackgroundColor,primaryFontClass:r[o.primaryFontClass],childBackgroundColor:o.childBackgroundColor,childFontClass:r[o.childFontClass],outlineBackgroundColor:o.outlineBackgroundColor,unreadColor:o.unreadColor,secondaryFontClass:r[o.secondaryFontClass]};break}if(a&&"None"!=a&&(e=o[a],c&&(e=Object.assign({},e,c)),s&&s.length>0))for(const r of s)null==r.data.attributes.position&&i.children.push(m("span",{class:"TagLabel",style:"--tag-bg:"+r.color()},m("span",{class:B()("TagLabel-text",e.secondaryFontClass?e.secondaryFontClass:g()(r.color()))},m("i",{class:"TagLabel-icon "+r.data.attributes.icon}),m("span",{class:"TagLabel-name"},r.data.attributes.name))))}(0,s.extend)(u().prototype,"view",(function(r){const o=this.attrs.discussion;if(e){const s=r.children.find((r=>r&&"div"===r.tag&&r.attrs&&r.attrs.className.includes("DiscussionListItem-content")));if(s.children[0]=m("div",{className:"DiscussionListItem-author-container"},[s.children[0],s.children[1]]),delete s.children[1],s.children[3]=m("div",{className:"DiscussionListItem-stats"},s.children[3]),n){null==l&&(l=n);let r=e.isPrimaryTagBackgroundColorRequired?n.color():e.primaryBackgroundColor;if(e.isPrimaryTagAnButton){let o="DiscussionListItem-footer";switch(a){case"StickyNoteTab":case"StickyNoteOutlineTab":case"BasicTab":case"BasicOutlineTab":case"FlatTab":case"FlatBorderTab":o="DiscussionListItem--tabfooter"}s.children.push(m("span",{class:o},m("span",{class:"PrimaryTagLabel",style:"background:"+r},m("span",{class:B()("PrimaryTagLabel-text",e.primaryFontClass?e.primaryFontClass:g()(r))},m("i",{class:"PrimaryTagLabel-icon "+n.data.attributes.icon+" fa-1x"}),m("span",{class:"PrimaryTagLabel-name"},n.data.attributes.name))),i))}else s.children.push(m("span",{class:B()("DiscussionListItem-footer",e.primaryFontClass?e.primaryFontClass:g()(r)),style:"background:"+r},m("span",{class:"DiscussionListItem--primary"},m("i",{"aria-hidden":"true",class:"TagLabel-icon "+n.data.attributes.icon+" fa-1x"}),n.data.attributes.name),i))}let t=e.outlineBackgroundColor;switch(l&&(t=l.color()),a){case"StickyNoteTab":case"BasicTab":l&&s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -15px -15px 0px 0px "+t}));break;case"StickyNoteOutline":case"StickyNoteOutlineTag":case"StickyNoteOutlineBanner":case"BasicOutline":case"BasicOutlineTag":case"BasicOutlineBanner":s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+t+"; height: 100%; bottom: 0;"}));break;case"FlatBorder":case"FlatBorderTag":case"FlatBorderBanner":s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+t+"; height: 100%; bottom: 0;"}));break;case"StickyNoteOutlineTab":case"BasicOutlineTab":l?s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+t+";height: calc(100% - 18px); bottom: 18px;"})):s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+t+"; height: 100%; bottom: 0;"}));break;case"FlatBorderTab":l?s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+t+";height: calc(100% - 18px); bottom: 22px;"})):s.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+t+"; height: 100%; bottom: 0;"}))}const u=e.unreadCSS;r.attrs.style=F(l?{background:e.isChildTagBackgroundColorRequired?l.color():e.childBackgroundColor}:{background:e.childBackgroundColor},r.attrs.style||{}),o.isUnread()&&s.children.push(m("span",{class:"DiscussionListItem--unreadoutline"+u,style:"background:"+e.unreadColor+"; color:"+e.unreadColor})),"folded"==u&&(l?(r.attrs.style=F({background:e.isChildTagBackgroundColorRequired?l.color():e.childBackgroundColor},r.attrs.style||{}),s.children.push(m("span",{class:"DiscussionListItem--read"+u,style:"border-color:"+(e.isOutlineTagBackgroundColorRequired?l.color():e.outlineBackgroundColor)}))):s.children.push(m("span",{class:"DiscussionListItem--read"+u,style:"border-color:"+e.outlineBackgroundColor}))),r.attrs.className+=" TagWithThemes "+a}})),(0,s.override)(u().prototype,"mainView",(function(){const r=this.attrs.discussion,o=this.getJumpTo();if(r.isTagWithThemesEnabled()&&(t(r.tags(),app),e)){let a=g()(e.childBackgroundColor);return e.isChildTagBackgroundColorRequired&&(l?a=e.childFontClass?e.childFontClass:g()(l.color()):n&&(a=e.childFontClass?e.childFontClass:g()(n.color()))),m(h(),{href:app.route.discussion(r,o),className:"DiscussionListItem-main"},m("h2",{className:B()("DiscussionListItem-title-edit",a)},p()(r.title(),this.highlightRegExp)),m("ul",{className:B()("DiscussionListItem-info-edit",a)},T()(this.infoItems().toArray())))}return m(h(),{href:app.route.discussion(r,o),className:"DiscussionListItem-main"},m("h2",{className:"DiscussionListItem-title"},p()(r.title(),this.highlightRegExp)),m("ul",{className:"DiscussionListItem-info"},T()(this.infoItems().toArray())))})),(0,s.extend)(u().prototype,"infoItems",(function(r){const o=this.attrs.discussion;if(o.isTagWithThemesEnabled()&&!e&&t(o.tags(),app),e){let a=null;if(o.tags()&&o.tags().length>1)for(const r of o.tags())if(r.data.attributes.isChild){a=r;break}if(!r.has("excerpt")){const a=o.firstPost();if(a){const o=(0,c.truncate)(a.contentPlain(),175);r.add("excerpt",m("div",null,o),-100)}}r.has("tags")&&r.remove("tags"),a?r.add("tag",m("span",{class:"TagLabel-inner"},m("center",null,m("i",{"aria-hidden":"true",class:"TagLabel-icon "+a.data.attributes.icon+" fa-1x"}),a.data.attributes.name)),-100):r.add("tag",m("span",{class:"TagLabel-inner"}),-100)}}))}()}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map