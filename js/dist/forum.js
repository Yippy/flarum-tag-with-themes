(()=>{var o={n:r=>{var a=r&&r.__esModule?()=>r.default:()=>r;return o.d(a,{a}),a},d:(r,a)=>{for(var e in a)o.o(a,e)&&!o.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:a[e]})},o:(o,r)=>Object.prototype.hasOwnProperty.call(o,r)};(()=>{"use strict";const r=flarum.reg.get("core","common/models/Discussion");var a=o.n(r);const e=flarum.reg.get("core","common/Model");var i=o.n(e);function n(o){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},n(o)}function l(o,r,a){return(r=function(o){var r=function(o){if("object"!=n(o)||!o)return o;var r=o[Symbol.toPrimitive];if(void 0!==r){var a=r.call(o,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(o);return"symbol"==n(r)?r:r+""}(r))in o?Object.defineProperty(o,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[r]=a,o}const t=flarum.reg.get("core","common/extend"),s=flarum.reg.get("core","forum/components/DiscussionListItem");var c=o.n(s);const u=flarum.reg.get("core","common/utils/string"),d=flarum.reg.get("core","common/helpers/textContrastClass");var g=o.n(d);const C=flarum.reg.get("core","common/utils/classList");var y=o.n(C);const p=flarum.reg.get("core","common/components/Link");var B=o.n(p);const k=flarum.reg.get("core","common/helpers/highlight");var h=o.n(k);const f=flarum.reg.get("core","common/helpers/listItems");var T=o.n(f);function F(o,r){var a=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);r&&(e=e.filter((function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable}))),a.push.apply(a,e)}return a}function b(o){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?F(Object(a),!0).forEach((function(r){l(o,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(a,r))}))}return o}app.initializers.add("yippy-tag-with-themes",(()=>{a().prototype.isTagWithThemesEnabled=i().attribute("isTagWithThemesEnabled"),function(){const o={Automatic:null,White:"text-contrast--light",WhiteWithBorder:"outlinetextblackborder",Black:"text-contrast--dark",BlackWithBorder:"outlinetextwhiteborder"},r={StickyNote:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},StickyNoteOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},Basic:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},BasicOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},Flat:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorder:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorderTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorderTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1},FlatBorderBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null,opacityBackground:1,opacityFooter:1,opacityOutline:1}};let a,e,i,n,l;function s(t,s){a=e=i=n=null,l={tag:"span",attrs:{class:"DiscussionListItem--secondary",style:{}},children:[]},a=s.forum.attribute("yippy-tag-with-themes.designDefault");const c=s.forum.attribute("yippy-tag-with-themes.designByTags");let u=null;if(t&&t.length>0)for(const o of t)o.data.attributes.isChild?n=o:null==o.data.attributes.position||(i=o);if(i)for(const r of c)if(r.isEnabled&&r.tags.includes(i.id())){a=r.themeName,u={primaryBackgroundColor:r.primaryBackgroundColor,primaryFontClass:o[r.primaryFontClass],childBackgroundColor:r.childBackgroundColor,childFontClass:o[r.childFontClass],outlineBackgroundColor:r.outlineBackgroundColor,unreadColor:r.unreadColor,secondaryFontClass:o[r.secondaryFontClass],opacityBackground:r.opacityBackground,opacityFooter:r.opacityFooter,opacityOutline:r.opacityOutline};break}if(a&&"None"!=a&&(e=r[a],u&&(e=Object.assign({},e,u)),t&&t.length>0))for(const o of t)null==o.data.attributes.position&&l.children.push(m("span",{class:"TagLabel",style:"--tag-bg:"+o.color()},m("span",{class:y()("TagLabel-text",e.secondaryFontClass?e.secondaryFontClass:g()(o.color()))},m("i",{class:"TagLabel-icon "+o.data.attributes.icon}),m("span",{class:"TagLabel-name"},o.data.attributes.name))))}function d(o,r){var a=parseInt(o.slice(1,3),16),e=parseInt(o.slice(3,5),16),i=parseInt(o.slice(5,7),16);return r?"rgba("+a+", "+e+", "+i+", "+r+")":"rgb("+a+", "+e+", "+i+")"}(0,t.extend)(c().prototype,"view",(function(o){const r=this.attrs.discussion;if(e){const t=o.children.find((o=>o&&"div"===o.tag&&o.attrs&&o.attrs.className.includes("DiscussionListItem-content")));t.children[0]=m("div",{className:"DiscussionListItem-author-container"},[t.children[0],t.children[1]]),delete t.children[1],t.children[3]=m("div",{className:"DiscussionListItem-stats"},t.children[3]);let s=e.opacityFooter;if(i){null==n&&(n=i);let o=e.isPrimaryTagBackgroundColorRequired?i.color():e.primaryBackgroundColor,r=d(o,s);if(e.isPrimaryTagAnButton){let n="DiscussionListItem-footer";switch(a){case"StickyNoteTab":case"StickyNoteOutlineTab":case"BasicTab":case"BasicOutlineTab":case"FlatTab":case"FlatBorderTab":n="DiscussionListItem--tabfooter"}t.children.push(m("span",{class:n},m("span",{class:"PrimaryTagLabel",style:"background:"+r},m("span",{class:y()("PrimaryTagLabel-text",e.primaryFontClass?e.primaryFontClass:g()(o))},m("i",{class:"PrimaryTagLabel-icon "+i.data.attributes.icon+" fa-1x"}),m("span",{class:"PrimaryTagLabel-name"},i.data.attributes.name))),l))}else t.children.push(m("span",{class:y()("DiscussionListItem-footer",e.primaryFontClass?e.primaryFontClass:g()(o)),style:"background:"+r},m("span",{class:"DiscussionListItem--primary"},m("i",{"aria-hidden":"true",class:"TagLabel-icon "+i.data.attributes.icon+" fa-1x"}),i.data.attributes.name),l))}let c=e.outlineBackgroundColor,u=e.opacityOutline;switch(n&&(c=n.color()),c=d(c,u),a){case"StickyNoteTab":case"BasicTab":n&&t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -15px -15px 0px 0px "+c}));break;case"StickyNoteOutline":case"StickyNoteOutlineTag":case"StickyNoteOutlineBanner":case"BasicOutline":case"BasicOutlineTag":case"BasicOutlineBanner":t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+c+"; height: 100%; bottom: 0;"}));break;case"FlatBorder":case"FlatBorderTag":case"FlatBorderBanner":t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+c+"; height: 100%; bottom: 0;"}));break;case"StickyNoteOutlineTab":case"BasicOutlineTab":n?t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+c+";height: calc(100% - 18px); bottom: 18px;"})):t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+c+"; height: 100%; bottom: 0;"}));break;case"FlatBorderTab":n?t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+c+";height: calc(100% - 18px); bottom: 22px;"})):t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+c+"; height: 100%; bottom: 0;"}))}const C=e.unreadCSS;let p=e.opacityBackground;o.attrs.style=b(n?{background:e.isChildTagBackgroundColorRequired?d(n.color(),p):d(e.childBackgroundColor,p)}:{background:d(e.childBackgroundColor,p)},o.attrs.style||{}),r.isUnread()&&t.children.push(m("span",{class:"DiscussionListItem--unreadoutline"+C,style:"background:"+e.unreadColor+"; color:"+e.unreadColor})),"folded"==C&&(n?(o.attrs.style=b({background:e.isChildTagBackgroundColorRequired?n.color():e.childBackgroundColor},o.attrs.style||{}),t.children.push(m("span",{class:"DiscussionListItem--read"+C,style:"border-color:"+(e.isOutlineTagBackgroundColorRequired?n.color():e.outlineBackgroundColor)}))):t.children.push(m("span",{class:"DiscussionListItem--read"+C,style:"border-color:"+e.outlineBackgroundColor}))),o.attrs.className+=" TagWithThemes "+a}})),(0,t.override)(c().prototype,"mainView",(function(){const o=this.attrs.discussion,r=this.getJumpTo();if(o.isTagWithThemesEnabled()&&(s(o.tags(),app),e)){let a=g()(e.childBackgroundColor);return e.isChildTagBackgroundColorRequired&&(n?a=e.childFontClass?e.childFontClass:g()(n.color()):i&&(a=e.childFontClass?e.childFontClass:g()(i.color()))),m(B(),{href:app.route.discussion(o,r),className:"DiscussionListItem-main"},m("h2",{className:y()("DiscussionListItem-title-edit",a)},h()(o.title(),this.highlightRegExp)),m("ul",{className:y()("DiscussionListItem-info-edit",a)},T()(this.infoItems().toArray())))}return m(B(),{href:app.route.discussion(o,r),className:"DiscussionListItem-main"},m("h2",{className:"DiscussionListItem-title"},h()(o.title(),this.highlightRegExp)),m("ul",{className:"DiscussionListItem-info"},T()(this.infoItems().toArray())))})),(0,t.extend)(c().prototype,"infoItems",(function(o){const r=this.attrs.discussion;if(r.isTagWithThemesEnabled()&&!e&&s(r.tags(),app),e){let a=null;if(r.tags()&&r.tags().length>1)for(const o of r.tags())if(o.data.attributes.isChild){a=o;break}if(!o.has("excerpt")){const a=r.firstPost();if(a){const r=(0,u.truncate)(a.contentPlain(),175);o.add("excerpt",m("div",null,r),-100)}}o.has("tags")&&o.remove("tags"),a?o.add("tag",m("span",{class:"TagLabel-inner"},m("center",null,m("i",{"aria-hidden":"true",class:"TagLabel-icon "+a.data.attributes.icon+" fa-1x"}),a.data.attributes.name)),-100):o.add("tag",m("span",{class:"TagLabel-inner"}),-100)}}))}()}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map