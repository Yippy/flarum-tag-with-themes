(()=>{var r={n:o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return r.d(a,{a}),a},d:(o,a)=>{for(var n in a)r.o(a,n)&&!r.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:a[n]})},o:(r,o)=>Object.prototype.hasOwnProperty.call(r,o)};(()=>{"use strict";const o=flarum.core.compat["common/models/Discussion"];var a=r.n(o);const n=flarum.core.compat["common/Model"];var e=r.n(n);function l(){return l=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var n in a)({}).hasOwnProperty.call(a,n)&&(r[n]=a[n])}return r},l.apply(null,arguments)}const i=flarum.core.compat["common/extend"],s=flarum.core.compat["forum/components/DiscussionListItem"];var t=r.n(s);const u=flarum.core.compat["utils/string"],c=flarum.core.compat["common/helpers/textContrastClass"];var d=r.n(c);const g=flarum.core.compat["common/utils/classList"];var C=r.n(g);const B=flarum.core.compat["common/components/Link"];var h=r.n(B);const y=flarum.core.compat["common/helpers/highlight"];var k=r.n(y);const p=flarum.core.compat["common/helpers/listItems"];var T=r.n(p);function f(r,o){var a="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(a)return(a=a.call(r)).next.bind(a);if(Array.isArray(r)||(a=function(r,o){if(r){if("string"==typeof r)return F(r,o);var a={}.toString.call(r).slice(8,-1);return"Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a?Array.from(r):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?F(r,o):void 0}}(r))||o&&r&&"number"==typeof r.length){a&&(r=a);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(r,o){(null==o||o>r.length)&&(o=r.length);for(var a=0,n=Array(o);a<o;a++)n[a]=r[a];return n}app.initializers.add("yippy-tag-with-themes",(function(){a().prototype.isTagWithThemesEnabled=e().attribute("isTagWithThemesEnabled"),function(){var r,o,a,n,e,s={Automatic:null,White:"text-contrast--light",WhiteWithBorder:"outlinetextblackborder",Black:"text-contrast--dark",BlackWithBorder:"outlinetextwhiteborder"},c={StickyNote:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},StickyNoteOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"folded",secondaryFontClass:null},Basic:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutline:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutlineTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutlineTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},BasicOutlineBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"circle",secondaryFontClass:null},Flat:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!0,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!1,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorder:{isPrimaryTagBackgroundColorRequired:!1,isPrimaryTagAnButton:!1,primaryBackgroundColor:"transparent",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorderTag:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorderTab:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!0,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null},FlatBorderBanner:{isPrimaryTagBackgroundColorRequired:!0,isPrimaryTagAnButton:!1,primaryBackgroundColor:"#e8ecf3",primaryFontClass:null,isChildTagBackgroundColorRequired:!1,childBackgroundColor:"#e8ecf3",childFontClass:null,isOutlineTagBackgroundColorRequired:!0,outlineBackgroundColor:"#595a58",unreadColor:"#2199fc",unreadCSS:"square",secondaryFontClass:null}};function g(l,i){r=o=a=n=null,e={tag:"span",attrs:{class:"DiscussionListItem--secondary",style:{}},children:[]},r=i.forum.attribute("yippy-tag-with-themes.designDefault");var t=i.forum.attribute("yippy-tag-with-themes.designByTags"),u=null;if(l&&l.length>0)for(var g,B=f(l);!(g=B()).done;){var h=g.value;h.data.attributes.isChild?n=h:null==h.data.attributes.position||(a=h)}if(a)for(var y,k=f(t);!(y=k()).done;){var p=y.value;if(p.isEnabled&&p.tags.includes(a.id())){r=p.themeName,u={primaryBackgroundColor:p.primaryBackgroundColor,primaryFontClass:s[p.primaryFontClass],childBackgroundColor:p.childBackgroundColor,childFontClass:s[p.childFontClass],outlineBackgroundColor:p.outlineBackgroundColor,unreadColor:p.unreadColor,secondaryFontClass:s[p.secondaryFontClass]};break}}if(r&&"None"!=r&&(o=c[r],u&&(o=Object.assign({},o,u)),l&&l.length>0))for(var T,F=f(l);!(T=F()).done;){var b=T.value;null==b.data.attributes.position&&e.children.push(m("span",{class:"TagLabel",style:"--tag-bg:"+b.color()},m("span",{class:C()("TagLabel-text",o.secondaryFontClass?o.secondaryFontClass:d()(b.color()))},m("i",{class:"TagLabel-icon "+b.data.attributes.icon}),m("span",{class:"TagLabel-name"},b.data.attributes.name))))}}(0,i.extend)(t().prototype,"view",(function(i){var s=this.attrs.discussion;if(o){var t=i.children.find((function(r){return r&&"div"===r.tag&&r.attrs&&r.attrs.className.includes("DiscussionListItem-content")}));if(t.children[0]=m("div",{className:"DiscussionListItem-author-container"},[t.children[0],t.children[1]]),delete t.children[1],t.children[3]=m("div",{className:"DiscussionListItem-stats"},t.children[3]),a){null==n&&(n=a);var u=o.isPrimaryTagBackgroundColorRequired?a.color():o.primaryBackgroundColor;if(o.isPrimaryTagAnButton){var c="DiscussionListItem-footer";switch(r){case"StickyNoteTab":case"StickyNoteOutlineTab":case"BasicTab":case"BasicOutlineTab":case"FlatTab":case"FlatBorderTab":c="DiscussionListItem--tabfooter"}t.children.push(m("span",{class:c},m("span",{class:"PrimaryTagLabel",style:"background:"+u},m("span",{class:C()("PrimaryTagLabel-text",o.primaryFontClass?o.primaryFontClass:d()(u))},m("i",{class:"PrimaryTagLabel-icon "+a.data.attributes.icon+" fa-1x"}),m("span",{class:"PrimaryTagLabel-name"},a.data.attributes.name))),e))}else t.children.push(m("span",{class:C()("DiscussionListItem-footer",o.primaryFontClass?o.primaryFontClass:d()(u)),style:"background:"+u},m("span",{class:"DiscussionListItem--primary"},m("i",{"aria-hidden":"true",class:"TagLabel-icon "+a.data.attributes.icon+" fa-1x"}),a.data.attributes.name),e))}var g=o.outlineBackgroundColor;switch(n&&(g=n.color()),r){case"StickyNoteTab":case"BasicTab":n&&t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -15px -15px 0px 0px "+g}));break;case"StickyNoteOutline":case"StickyNoteOutlineTag":case"StickyNoteOutlineBanner":case"BasicOutline":case"BasicOutlineTag":case"BasicOutlineBanner":t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+g+"; height: 100%; bottom: 0;"}));break;case"FlatBorder":case"FlatBorderTag":case"FlatBorderBanner":t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+g+"; height: 100%; bottom: 0;"}));break;case"StickyNoteOutlineTab":case"BasicOutlineTab":n?t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+g+";height: calc(100% - 18px); bottom: 18px;"})):t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset -6px -6px 0px 0px "+g+"; height: 100%; bottom: 0;"}));break;case"FlatBorderTab":n?t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+g+";height: calc(100% - 18px); bottom: 22px;"})):t.children.push(m("span",{class:"DiscussionListItem--outline",style:"box-shadow:inset 0 0 0 4px "+g+"; height: 100%; bottom: 0;"}))}var B=o.unreadCSS;i.attrs.style=l(n?{background:o.isChildTagBackgroundColorRequired?n.color():o.childBackgroundColor}:{background:o.childBackgroundColor},i.attrs.style||{}),s.isUnread()&&t.children.push(m("span",{class:"DiscussionListItem--unreadoutline"+B,style:"background:"+o.unreadColor+"; color:"+o.unreadColor})),"folded"==B&&(n?(i.attrs.style=l({background:o.isChildTagBackgroundColorRequired?n.color():o.childBackgroundColor},i.attrs.style||{}),t.children.push(m("span",{class:"DiscussionListItem--read"+B,style:"border-color:"+(o.isOutlineTagBackgroundColorRequired?n.color():o.outlineBackgroundColor)}))):t.children.push(m("span",{class:"DiscussionListItem--read"+B,style:"border-color:"+o.outlineBackgroundColor}))),i.attrs.className+=" TagWithThemes "+r}})),(0,i.override)(t().prototype,"mainView",(function(){var r=this.attrs.discussion,e=this.getJumpTo();if(r.isTagWithThemesEnabled()&&(g(r.tags(),app),o)){var l=d()(o.childBackgroundColor);return o.isChildTagBackgroundColorRequired&&(n?l=o.childFontClass?o.childFontClass:d()(n.color()):a&&(l=o.childFontClass?o.childFontClass:d()(a.color()))),m(h(),{href:app.route.discussion(r,e),className:"DiscussionListItem-main"},m("h2",{className:C()("DiscussionListItem-title-edit",l)},k()(r.title(),this.highlightRegExp)),m("ul",{className:C()("DiscussionListItem-info-edit",l)},T()(this.infoItems().toArray())))}return m(h(),{href:app.route.discussion(r,e),className:"DiscussionListItem-main"},m("h2",{className:"DiscussionListItem-title"},k()(r.title(),this.highlightRegExp)),m("ul",{className:"DiscussionListItem-info"},T()(this.infoItems().toArray())))})),(0,i.extend)(t().prototype,"infoItems",(function(r){var a=this.attrs.discussion;if(a.isTagWithThemesEnabled()&&!o&&g(a.tags(),app),o){var n=null;if(a.tags()&&a.tags().length>1)for(var e,l=f(a.tags());!(e=l()).done;){var i=e.value;if(i.data.attributes.isChild){n=i;break}}if(!r.has("excerpt")){var s=a.firstPost();if(s){var t=(0,u.truncate)(s.contentPlain(),175);r.add("excerpt",m("div",null,t),-100)}}r.has("tags")&&r.remove("tags"),n?r.add("tag",m("span",{class:"TagLabel-inner"},m("center",null,m("i",{"aria-hidden":"true",class:"TagLabel-icon "+n.data.attributes.icon+" fa-1x"}),n.data.attributes.name)),-100):r.add("tag",m("span",{class:"TagLabel-inner"}),-100)}}))}()}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map